From 88e9cfdb8c0e5276b075401e2115a48950ade7a7 Mon Sep 17 00:00:00 2001
From: mochangming <mochangming@xiaomi.com>
Date: Fri, 17 Aug 2012 15:32:35 +0800
Subject: [PATCH] support the shutdown alarm clock

---
 .../android/deskclock/AlarmInitReceiver$1.smali    |    5 -----
 DeskClock/smali/com/android/deskclock/Alarms.smali |    4 +++-
 2 files changed, 3 insertions(+), 6 deletions(-)

--- a/DeskClock/smali/com/android/deskclock/AlarmInitReceiver$1.smali
+++ b/DeskClock/smali/com/android/deskclock/AlarmInitReceiver$1.smali
@@ -80,10 +80,6 @@
 
     invoke-virtual {v0}, Lmiui/net/FirewallManager;->setAlarmBootCompleted()V
 
-    sget-boolean v0, Lmiui/os/Build;->IS_MIONE:Z
-
-    if-eqz v0, :cond_3
-
     invoke-static {}, Ljava/lang/System;->currentTimeMillis()J
 
     move-result-wide v0
--- a/DeskClock/smali/com/android/deskclock/Alarms.smali
+++ b/DeskClock/smali/com/android/deskclock/Alarms.smali
@@ -1134,7 +1134,9 @@
     move-result-object v4
 
     .local v4, sender:Landroid/app/PendingIntent;
-    invoke-virtual {v0, v8, p2, p3, v4}, Landroid/app/AlarmManager;->set(IJLandroid/app/PendingIntent;)V
+    const/4 v6, 0x4
+
+    invoke-virtual {v0, v6, p2, p3, v4}, Landroid/app/AlarmManager;->set(IJLandroid/app/PendingIntent;)V
 
     const/4 v6, 0x1
 
-- 
1.7.1

